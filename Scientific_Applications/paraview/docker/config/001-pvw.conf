<VirtualHost *:80>
  DocumentRoot /pvw-website/
  ErrorLog /var/log/apache2/001-pvw_error.log
  CustomLog /var/log/apache2/001-pvw_access.log combined

  <Directory /pvw-website/>
      Options Indexes FollowSymLinks
      Order allow,deny
      Allow from all
      AllowOverride None
      Require all granted
  </Directory>

  Alias "/glance" "/opt/paraview/share/paraview-5.6/web/glance/www"

  <Directory /opt/paraview/share/paraview-5.6/web/glance/www>
      Options Indexes FollowSymLinks
      Order allow,deny
      Allow from all
      AllowOverride None
      Require all granted
    </Directory>

  Alias "/lite" "/opt/paraview/share/paraview-5.6/web/lite/www"

  <Directory /opt/paraview/share/paraview-5.6/web/lite/www>
      Options Indexes FollowSymLinks
      Order allow,deny
      Allow from all
      AllowOverride None
      Require all granted
    </Directory>

  Alias "/divvy" "/opt/paraview/share/paraview-5.6/web/divvy/www"

  <Directory /opt/paraview/share/paraview-5.6/web/divvy/www>
      Options Indexes FollowSymLinks
      Order allow,deny
      Allow from all
      AllowOverride None
      Require all granted
    </Directory>

  Alias "/visualizer" "/opt/paraview/share/paraview-5.6/web/visualizer/www"

  <Directory /opt/paraview/share/paraview-5.6/web/visualizer/www>
      Options Indexes FollowSymLinks
      Order allow,deny
      Allow from all
      AllowOverride None
      Require all granted
    </Directory>

  # APPLICATION-ENDPOINTS

  # Handle launcher forwarding
  ProxyPass /paraview http://localhost:9000/paraview

  # Handle WebSocket forwarding
  RewriteEngine On
  RewriteMap session-to-port txt:/opt/launcher/proxy-mapping.txt
  RewriteCond %{QUERY_STRING} ^sessionId=(.*)&path=(.*)$ [NC]
  RewriteRule ^/proxy.*$  ws://${session-to-port:%1}/%2  [P]
</VirtualHost>